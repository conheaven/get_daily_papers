<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è®ºæ–‡æµè§ˆ - Academic Paper Crawler</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-content">
            <a href="/" class="navbar-brand">
                <span>ğŸ“š</span>
                <span>Academic Papers</span>
            </a>
            <ul class="navbar-nav">
                <li><a href="/">æµè§ˆè®ºæ–‡</a></li>
                <li><a href="/crawl">çˆ¬å–ç®¡ç†</a></li>
                <li><a href="/statistics">ç»Ÿè®¡ä¿¡æ¯</a></li>
                <li><a href="/config">é…ç½®</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="stats-grid fade-in">
            <div class="stat-card">
                <div class="stat-value">{{ stats.total_papers }}</div>
                <div class="stat-label">æ€»è®ºæ–‡æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ stats.by_conference|length }}</div>
                <div class="stat-label">ä¼šè®®æ•°é‡</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ total }}</div>
                <div class="stat-label">ç­›é€‰ç»“æœ</div>
            </div>
        </div>

        <div class="filter-bar fade-in">
            <form method="get" action="/" class="filter-form">
                <div class="form-group">
                    <label class="form-label">ä¼šè®®</label>
                    <select name="conference">
                        <option value="">å…¨éƒ¨ä¼šè®®</option>
                        {% for conf in conferences %}
                        <option value="{{ conf }}" {% if conf == conference %}selected{% endif %}>{{ conf }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">å¹´ä»½</label>
                    <select name="year">
                        <option value="">å…¨éƒ¨å¹´ä»½</option>
                        {% for y in years %}
                        <option value="{{ y }}" {% if y|string == year %}selected{% endif %}>{{ y }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="form-group" style="flex: 2;">
                    <label class="form-label">æœç´¢</label>
                    <input type="text" name="search" placeholder="æœç´¢æ ‡é¢˜æˆ–ä½œè€…..." value="{{ search }}">
                </div>
                
                <button type="submit" class="btn btn-primary">ç­›é€‰</button>
                <a href="/" class="btn btn-secondary">é‡ç½®</a>
            </form>
        </div>

        {% if papers %}
        <div class="papers-list fade-in">
            {% for paper in papers %}
            <div class="paper-item">
                <div class="paper-title">
                    <a href="/paper/{{ paper.id }}">{{ paper.title }}</a>
                </div>
                <div class="paper-meta">
                    <span>ğŸ“… {{ paper.conference }} {{ paper.year }}</span>
                    <span>ğŸ•’ {{ paper.created_at[:10] }}</span>
                </div>
                <div class="paper-authors">
                    ğŸ‘¥ {{ paper.authors or 'ä½œè€…ä¿¡æ¯æœªæä¾›' }}
                </div>
                <div class="paper-links">
                    {% if paper.pdf_url %}
                    <a href="{{ paper.pdf_url }}" target="_blank">ğŸ“„ PDF</a>
                    {% endif %}
                    {% if paper.paper_url %}
                    <a href="{{ paper.paper_url }}" target="_blank">ğŸ”— é“¾æ¥</a>
                    {% endif %}
                    {% if paper.doi %}
                    <a href="{{ paper.doi }}" target="_blank">ğŸ” DOI</a>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="card empty-state fade-in">
            <div class="empty-state-icon">ğŸ“­</div>
            <h3>æš‚æ— è®ºæ–‡æ•°æ®</h3>
            <p>è¯·å‰å¾€<a href="/crawl">çˆ¬å–ç®¡ç†</a>é¡µé¢å¼€å§‹çˆ¬å–è®ºæ–‡</p>
        </div>
        {% endif %}

        {% if total_pages > 1 %}
        <div class="pagination">
            {% if page > 1 %}
            <a href="?page={{ page - 1 }}&conference={{ conference }}&year={{ year }}&search={{ search }}">â† ä¸Šä¸€é¡µ</a>
            {% endif %}
            
            {% for p in range(1, total_pages + 1) %}
                {% if p == page %}
                    <span class="current">{{ p }}</span>
                {% elif p == 1 or p == total_pages or (p >= page - 2 and p <= page + 2) %}
                    <a href="?page={{ p }}&conference={{ conference }}&year={{ year }}&search={{ search }}">{{ p }}</a>
                {% elif p == page - 3 or p == page + 3 %}
                    <span>...</span>
                {% endif %}
            {% endfor %}
            
            {% if page < total_pages %}
            <a href="?page={{ page + 1 }}&conference={{ conference }}&year={{ year }}&search={{ search }}">ä¸‹ä¸€é¡µ â†’</a>
            {% endif %}
        </div>
        {% endif %}
    </div>
</body>
</html>
